mapscripts PetalburgCity_Gym_MapScripts {
    MAP_SCRIPT_ON_LOAD {
        goto_if_eq(VAR_PETALBURG_GYM_STATE, 6, PetalburgCity_Gym_EventScript_OpenUnlockedDoors)
        call_if_ge(VAR_PETALBURG_GYM_STATE, 7, PetalburgCity_Gym_EventScript_UnlockAllDoors)
    }
    MAP_SCRIPT_ON_TRANSITION {
        call_if_eq(VAR_PETALBURG_GYM_STATE, 1, PetalburgCity_Gym_EventScript_MoveWallyToEntrance)
        call_if_lt(VAR_PETALBURG_GYM_STATE, 6, PetalburgCity_Gym_EventScript_MoveNormanToEntrance)
        call_if_set(FLAG_SYS_GAME_CLEAR, PetalburgCity_Gym_EventScript_CheckNormanForRematch)
    }
    MAP_SCRIPT_ON_WARP_INTO_MAP_TABLE [
        VAR_PETALBURG_GYM_STATE, 1 {
            turnobject(OBJ_EVENT_ID_PLAYER, DIR_NORTH)
            }
    ]
    MAP_SCRIPT_ON_FRAME_TABLE [
        VAR_PETALBURG_GYM_STATE, 1: PetalburgCity_Gym_EventScript_ReturnFromWallyTutorial
    ]
}

raw `
.set LOCALID_NORMAN, 1
.set LOCALID_WALLY, 10
.set LOCALID_WALLYS_DAD, 11

@ NOTE: Strength and OHKO rooms are misleading. Both are more accurately Critical-Hit
PetalburgCity_Gym_EventScript_OpenUnlockedDoors::
    setvar VAR_0x8005, 1
    call PetalburgCity_Gym_EventScript_OpenGymEntranceDoors
    call_if_defeated TRAINER_RANDALL, PetalburgCity_Gym_EventScript_OpenSpeedRoomDoors
    call_if_defeated TRAINER_MARY, PetalburgCity_Gym_EventScript_OpenAccuracyRoomDoors
    call_if_defeated TRAINER_PARKER, PetalburgCity_Gym_EventScript_OpenConfusionRoomDoors
    call_if_defeated TRAINER_ALEXIA, PetalburgCity_Gym_EventScript_OpenDefenseRoomDoors
    call_if_defeated TRAINER_GEORGE, PetalburgCity_Gym_EventScript_OpenRecoveryRoomDoors
    call_if_defeated TRAINER_JODY, PetalburgCity_Gym_EventScript_OpenStrengthRoomDoors
    call_if_defeated TRAINER_BERKE, PetalburgCity_Gym_EventScript_OpenOHKORoomDoors
    end

PetalburgCity_Gym_EventScript_UnlockAllDoors::
    setvar VAR_0x8005, 1
    call PetalburgCity_Gym_EventScript_OpenGymEntranceDoors
    call PetalburgCity_Gym_EventScript_OpenSpeedRoomDoors
    call PetalburgCity_Gym_EventScript_OpenAccuracyRoomDoors
    call PetalburgCity_Gym_EventScript_OpenConfusionRoomDoors
    call PetalburgCity_Gym_EventScript_OpenDefenseRoomDoors
    call PetalburgCity_Gym_EventScript_OpenRecoveryRoomDoors
    call PetalburgCity_Gym_EventScript_OpenStrengthRoomDoors
    call PetalburgCity_Gym_EventScript_OpenOHKORoomDoors
    return

PetalburgCity_Gym_EventScript_MoveWallyToEntrance::
    setobjectxyperm LOCALID_WALLY, 5, 108
    return

PetalburgCity_Gym_EventScript_MoveNormanToEntrance::
    setobjectxyperm LOCALID_NORMAN, 4, 107
    return

PetalburgCity_Gym_EventScript_CheckNormanForRematch::
    setorcopyvar VAR_TRAINER_BATTLE_OPPONENT_A, TRAINER_NORMAN_1
    specialvar VAR_RESULT, IsTrainerReadyForRematch
    goto_if_eq VAR_RESULT, TRUE, PetalburgCity_Gym_EventScript_DontMoveNormanToFront
    goto_if_eq VAR_PETALBURG_GYM_STATE, 8, PetalburgCity_Gym_EventScript_DontMoveNormanToFront
    setobjectxyperm LOCALID_NORMAN, 4, 107
    return

PetalburgCity_Gym_EventScript_DontMoveNormanToFront::
    setvar VAR_PETALBURG_GYM_STATE, 8
    end

PetalburgCity_Gym_Movement_WallyExitGym:
    walk_down
    walk_down
    walk_down
    delay_16
    step_end

PetalburgCity_Gym_EventScript_Norman::
    lock
    faceplayer
    switch VAR_PETALBURG_GYM_STATE
    case 2, PetalburgCity_Gym_EventScript_NormanNoBadges
    case 3, PetalburgCity_Gym_EventScript_NormanOneBadge
    case 4, PetalburgCity_Gym_EventScript_NormanTwoBadges
    case 5, PetalburgCity_Gym_EventScript_NormanThreeBadges
    case 6, PetalburgCity_Gym_EventScript_NormanBattle
    case 7, PetalburgCity_Gym_EventScript_NormanPostBattle
    case 8, PetalburgCity_Gym_EventScript_NormanRematch
    speakername CommonName_Text_Dad
    msgbox PetalburgCity_Gym_Text_DadYoureHereWithYourPokemon, MSGBOX_DEFAULT
    closemessage
    switch VAR_FACING
    case DIR_SOUTH, PetalburgCity_Gym_EventScript_BeginWallyTutorialSouth
    case DIR_NORTH, PetalburgCity_Gym_EventScript_BeginWallyTutorialNorth
    case DIR_WEST, PetalburgCity_Gym_EventScript_BeginWallyTutorialWest
    case DIR_EAST, PetalburgCity_Gym_EventScript_BeginWallyTutorialEast
    end

PetalburgCity_Gym_EventScript_BeginWallyTutorialSouth::
    setvar VAR_0x8008, 0
    goto PetalburgCity_Gym_EventScript_BeginWallyTutorial
    end

PetalburgCity_Gym_EventScript_BeginWallyTutorialNorth::
    setvar VAR_0x8008, 1
    goto PetalburgCity_Gym_EventScript_BeginWallyTutorial
    end

PetalburgCity_Gym_EventScript_BeginWallyTutorialWest::
    setvar VAR_0x8008, 2
    goto PetalburgCity_Gym_EventScript_BeginWallyTutorial
    end

PetalburgCity_Gym_EventScript_BeginWallyTutorialEast::
    setvar VAR_0x8008, 3
    goto PetalburgCity_Gym_EventScript_BeginWallyTutorial
    end

PetalburgCity_Gym_EventScript_WallyArriveSouth::
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterDown
    applymovement LOCALID_WALLY, PetalburgCity_Gym_Movement_WallyArrive
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_WallyArriveNorth::
    applymovement LOCALID_WALLY, PetalburgCity_Gym_Movement_WallyArriveNorth
    waitmovement 0
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterRight
    applymovement OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterRight
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_WallyArriveWestEast::
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterDown
    applymovement OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterDown
    applymovement LOCALID_WALLY, PetalburgCity_Gym_Movement_WallyArrive
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_ExitGymWithWallySouth::
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterDown
    applymovement LOCALID_WALLY, PetalburgCity_Gym_Movement_WallyExitSouthWest
    applymovement OBJ_EVENT_ID_PLAYER, PetalburgCity_Gym_Movement_PlayerExitWithWallySouth
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_ExitGymWithWallyNorth::
    applymovement LOCALID_WALLY, PetalburgCity_Gym_Movement_WallyExitNorth
    applymovement OBJ_EVENT_ID_PLAYER, PetalburgCity_Gym_Movement_PlayerExitWithWallyNorth
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_ExitGymWithWallyWest::
    applymovement LOCALID_WALLY, PetalburgCity_Gym_Movement_WallyExitSouthWest
    applymovement OBJ_EVENT_ID_PLAYER, PetalburgCity_Gym_Movement_PlayerExitWithWallyWest
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_ExitGymWithWallyEast::
    applymovement LOCALID_WALLY, PetalburgCity_Gym_Movement_WallyExitEast
    applymovement OBJ_EVENT_ID_PLAYER, PetalburgCity_Gym_Movement_PlayerExitWithWallyEast
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_NormanAddressPlayerSouth::
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterUp
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_NormanAddressPlayerNorth::
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterDown
    applymovement OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterUp
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_NormanAddressPlayerWest::
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterRight
    applymovement OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterLeft
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_NormanAddressPlayerEast::
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterLeft
    applymovement OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterRight
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_NormanAddressWallySouth::
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterDown
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_NormanAddressWallyNorth::
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterRight
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_NormanAddressWallyWest::
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterDown
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_NormanAddressWallyEast::
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterDown
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_WallyFacePlayer::
    applymovement LOCALID_WALLY, Common_Movement_FacePlayer
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_WallyFaceDown::
    applymovement LOCALID_WALLY, Common_Movement_WalkInPlaceFasterDown
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_NormanNoBadges::
    speakername CommonName_Text_Dad
    msgbox PetalburgCity_Gym_Text_NormanGoToRustboro, MSGBOX_DEFAULT
    release
    end

PetalburgCity_Gym_EventScript_NormanOneBadge::
    speakername CommonName_Text_Dad
    msgbox PetalburgCity_Gym_Text_NormanGoToDewford, MSGBOX_DEFAULT
    release
    end

PetalburgCity_Gym_EventScript_NormanTwoBadges::
    speakername CommonName_Text_Dad
    msgbox PetalburgCity_Gym_Text_YouHaveGottenStronger, MSGBOX_DEFAULT
    release
    end

PetalburgCity_Gym_EventScript_NormanThreeBadges::
    speakername CommonName_Text_Dad
    msgbox PetalburgCity_Gym_Text_YouHaveGottenStronger, MSGBOX_DEFAULT
    release
    end

PetalburgCity_Gym_EventScript_NormanFaceDoorSouth::
    return

@ For all other NormanFaceDoorX, Norman is already facing the door from NormanAddressWallyX
PetalburgCity_Gym_EventScript_NormanFaceDoorNorth::
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterDown
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_NormanFaceDoorWest::
    return

PetalburgCity_Gym_EventScript_NormanFaceDoorEast::
    return

PetalburgCity_Gym_EventScript_NormanPostBattle::
    call PetalburgCity_Gym_EventScript_ShouldGiveEnigmaBerry
    goto_if_eq VAR_RESULT, TRUE, PetalburgCity_Gym_EventScript_GiveEnigmaBerry
    goto_if_unset FLAG_RECEIVED_TM_FACADE, PetalburgCity_Gym_EventScript_GiveFacade2
    goto_if_set FLAG_SYS_GAME_CLEAR, PetalburgCity_Gym_EventScript_NoAmountOfTrainingIsEnough
    msgbox PetalburgCity_Gym_Text_DadGoingToKeepTraining, MSGBOX_DEFAULT
    release
    end

PetalburgCity_Gym_EventScript_GiveFacade2::
    call PetalburgCity_Gym_EventScript_GiveFacade
    release
    end

PetalburgCity_Gym_EventScript_NormanRematch::
    trainerbattle_rematch_double TRAINER_NORMAN_1, PetalburgCity_Gym_Text_NormanPreRematch, PetalburgCity_Gym_Text_NormanRematchDefeat, PetalburgCity_Gym_Text_NormanRematchNeedTwoMons
    msgbox PetalburgCity_Gym_Text_NormanPostRematch, MSGBOX_AUTOCLOSE
    end

PetalburgCity_Gym_EventScript_ShouldGiveEnigmaBerry::
    specialvar VAR_RESULT, IsEnigmaBerryValid
    goto_if_eq VAR_RESULT, FALSE, PetalburgCity_Gym_EventScript_DontGiveEnigmaBerry
    checkitem ITEM_ENIGMA_BERRY_E_READER
    goto_if_eq VAR_RESULT, TRUE, PetalburgCity_Gym_EventScript_DontGiveEnigmaBerry
    checkpcitem ITEM_ENIGMA_BERRY_E_READER
    goto_if_eq VAR_RESULT, TRUE, PetalburgCity_Gym_EventScript_DontGiveEnigmaBerry
    goto_if_eq VAR_ENIGMA_BERRY_AVAILABLE, 0, PetalburgCity_Gym_EventScript_DontGiveEnigmaBerry
    msgbox PetalburgCity_Gym_Text_GiveEnigmaBerry, MSGBOX_DEFAULT
    setvar VAR_RESULT, TRUE
    return

PetalburgCity_Gym_EventScript_DontGiveEnigmaBerry::
    setvar VAR_RESULT, FALSE
    return

PetalburgCity_Gym_EventScript_GiveEnigmaBerry::
    giveitem ITEM_ENIGMA_BERRY_E_READER
    goto_if_eq VAR_RESULT, FALSE, Common_EventScript_ShowBagIsFull
    setvar VAR_ENIGMA_BERRY_AVAILABLE, 0
    release
    end

`

script PetalburgCity_Gym_EventScript_NormanBattle {
    speakername(CommonName_Text_Dad)
    msgbox(format("Hm…\n"
        "So, you did get four Gym Badges.\p"
        "Fine, as I promised, we will have a Pokémon battle.\p"
        "{PLAYER}…\p"
        "I'm so happy that I can have a real battle with my own child.\p"
        "But a battle is a battle!\p"
        "I will do everything in my power as a Gym Leader to win.\p"
        "{PLAYER}, you'd better give it your best shot, too!"), MSGBOX_DEFAULT)
    special(HealPlayerParty)
    trainerbattle_no_intro(TRAINER_NORMAN_1, PetalburgCity_Gym_Text_NormanDefeat)
    message(format("{PLAYER} received the Balance Badge from Dad!"))
    waitmessage
    call(Common_EventScript_PlayGymBadgeFanfare)
    speakername(CommonName_Text_Dad)
    msgbox(format("With that Badge,\n"
        "Pokémon that know the HM move Surf will be able to travel over water.\p"
        "These are my gifts to you, {PLAYER}.\n"
        "I'm sure you can use them correctly."), MSGBOX_DEFAULT)
    message(format("{PLAYER} received the Mega Ring!"))
    giveitem(ITEM_MEGA_RING)
    speakername(CommonName_Text_Dad)
    msgbox(format("After giving your Pokémon a Mega Stone, press START when selecting a move to Mega Evolve it.\p"
        "Devon Corporation has been stocking Marts with them, thanks to Steven's efforts."), MSGBOX_DEFAULT)  
    setflag(FLAG_DEFEATED_PETALBURG_GYM)
    setvar(VAR_PETALBURG_GYM_STATE, 7)
    setflag(FLAG_BADGE05_GET)
    special(ResetHealLocationFromDewford)
    call(EventScript_HideMrBriney)
    setflag(FLAG_HIDE_MAUVILLE_GYM_WATTSON)
    clearflag(FLAG_HIDE_MAUVILLE_CITY_WATTSON)
    setvar(VAR_0x8008, 5)
    call(Common_EventScript_SetGymTrainers)
    clearflag(FLAG_HIDE_DEWFORD_HALL_SLUDGE_BOMB_MAN)
    call(PetalburgCity_Gym_EventScript_UnlockAllDoors)
    special(DrawWholeMapView)
    call(PetalburgCity_Gym_EventScript_GiveFacade)
    delay(30)
    speakername(CommonName_Text_Dad)
    msgbox(format("As the Gym Leader, I can't express how upset I am…\p"
        "But as a father, it makes me both happy and a little sad. It's odd…"), MSGBOX_DEFAULT)
    closemessage
    delay(40)
    playse(SE_DOOR)
    delay(10)
    addobject(LOCALID_WALLYS_DAD)
    switch (var(VAR_FACING)) {
        case DIR_NORTH:
            setvar(VAR_0x8008, 1)
        case DIR_EAST:
            setvar(VAR_0x8008, 2)
        case DIR_WEST:
            setvar(VAR_0x8008, 3)
    }
    goto(PetalburgCity_Gym_EventScript_WallysDadArrives)
}

raw `
PetalburgCity_Gym_EventScript_GiveFacade::
    giveitem ITEM_TM_FACADE
    goto_if_eq VAR_RESULT, FALSE, Common_EventScript_BagIsFull
    setflag FLAG_RECEIVED_TM_FACADE
    msgbox PetalburgCity_Gym_Text_ExplainFacade, MSGBOX_DEFAULT
    return


PetalburgCity_Gym_EventScript_WallysDadArrives::
    applymovement LOCALID_WALLYS_DAD, PetalburgCity_Gym_Movement_WallysDadEnterGym
    waitmovement 0
    playse SE_PIN
    applymovement LOCALID_WALLYS_DAD, Common_Movement_ExclamationMark
    waitmovement 0
    applymovement LOCALID_WALLYS_DAD, Common_Movement_Delay48
    waitmovement 0
    delay 10
    call_if_eq VAR_0x8008, 1, PetalburgCity_Gym_EventScript_WallysDadApproachPlayerNorth
    call_if_eq VAR_0x8008, 2, PetalburgCity_Gym_EventScript_WallysDadApproachPlayerEast
    call_if_eq VAR_0x8008, 3, PetalburgCity_Gym_EventScript_WallysDadApproachPlayerWest
    speakername CommonName_Text_WallysDad
    msgbox PetalburgCity_Gym_Text_PleaseComeWithMe, MSGBOX_DEFAULT
    closemessage
    delay 20
    call_if_eq VAR_0x8008, 1, PetalburgCity_Gym_EventScript_WallysDadFaceNormanNorth
    call_if_eq VAR_0x8008, 2, PetalburgCity_Gym_EventScript_WallysDadFaceNormanEast
    call_if_eq VAR_0x8008, 3, PetalburgCity_Gym_EventScript_WallysDadFaceNormanWest
    msgbox PetalburgCity_Gym_Text_LetMeBorrowPlayer, MSGBOX_DEFAULT
    closemessage
    setflag FLAG_DONT_TRANSITION_MUSIC
    playbgm MUS_FOLLOW_ME, FALSE
    call_if_eq VAR_0x8008, 1, PetalburgCity_Gym_EventScript_ExitGymWithWallysDadNorth
    call_if_eq VAR_0x8008, 2, PetalburgCity_Gym_EventScript_ExitGymWithWallysDadEast
    call_if_eq VAR_0x8008, 3, PetalburgCity_Gym_EventScript_ExitGymWithWallysDadWest
    removeobject LOCALID_WALLYS_DAD
    setvar VAR_PETALBURG_CITY_STATE, 4
    clearflag FLAG_HIDE_PETALBURG_CITY_WALLYS_DAD
    warp MAP_PETALBURG_CITY, 15, 8
    waitstate
    release
    end

PetalburgCity_Gym_EventScript_WallysDadFaceNormanNorth::
    applymovement LOCALID_WALLYS_DAD, Common_Movement_WalkInPlaceFasterUp
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_WallysDadFaceNormanEast::
    applymovement LOCALID_WALLYS_DAD, Common_Movement_WalkInPlaceFasterRight
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_WallysDadFaceNormanWest::
    applymovement LOCALID_WALLYS_DAD, Common_Movement_WalkInPlaceFasterLeft
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_WallysDadApproachPlayerNorth::
    applymovement LOCALID_WALLYS_DAD, PetalburgCity_Gym_Movement_WallysDadApproachPlayerNorth
    waitmovement 0
    applymovement OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterLeft
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterLeft
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_WallysDadApproachPlayerEast::
    applymovement LOCALID_WALLYS_DAD, PetalburgCity_Gym_Movement_WallysDadApproachPlayerEast
    waitmovement 0
    applymovement OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterDown
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterDown
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_WallysDadApproachPlayerWest::
    applymovement LOCALID_WALLYS_DAD, PetalburgCity_Gym_Movement_WallysDadApproachPlayerWest
    waitmovement 0
    applymovement OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterDown
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterDown
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_ExitGymWithWallysDadNorth::
    applymovement LOCALID_WALLYS_DAD, PetalburgCity_Gym_Movement_WallysDadExitNorth
    applymovement LOCALID_NORMAN, Common_Movement_WalkInPlaceFasterDown
    applymovement OBJ_EVENT_ID_PLAYER, PetalburgCity_Gym_Movement_PlayerExitWithWallysDadNorth
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_ExitGymWithWallysDadEast::
    applymovement LOCALID_WALLYS_DAD, PetalburgCity_Gym_Movement_WallysDadExitEast
    applymovement OBJ_EVENT_ID_PLAYER, PetalburgCity_Gym_Movement_PlayerExitWithWallysDadEast
    waitmovement 0
    return

PetalburgCity_Gym_EventScript_ExitGymWithWallysDadWest::
    applymovement LOCALID_WALLYS_DAD, PetalburgCity_Gym_Movement_WallysDadExitWest
    applymovement OBJ_EVENT_ID_PLAYER, PetalburgCity_Gym_Movement_PlayerExitWithWallysDadWest
    waitmovement 0
    return

PetalburgCity_Gym_Movement_WallysDadExitNorth:
    walk_down
    walk_down
    walk_left
    walk_left
    walk_down
    walk_down
    walk_in_place_faster_up
    delay_8
    walk_in_place_down
    set_invisible
    step_end

PetalburgCity_Gym_Movement_WallysDadExitEast:
    walk_down
    walk_down
    walk_left
    walk_left
    walk_down
    walk_down
    walk_in_place_faster_up
    delay_8
    walk_in_place_down
    set_invisible
    step_end

PetalburgCity_Gym_Movement_WallysDadExitWest:
    walk_down
    walk_down
    walk_left
    walk_left
    walk_left
    walk_left
    walk_down
    walk_down
    walk_in_place_faster_up
    delay_8
    walk_in_place_down
    set_invisible
    step_end

PetalburgCity_Gym_Movement_PlayerExitWithWallysDadNorth:
    delay_16
    walk_down
    walk_down
    walk_left
    walk_left
    walk_down
    walk_down
    step_end

PetalburgCity_Gym_Movement_PlayerExitWithWallysDadEast:
    delay_16
    walk_down
    walk_down
    walk_left
    walk_down
    walk_down
    walk_down
    step_end

PetalburgCity_Gym_Movement_PlayerExitWithWallysDadWest:
    delay_16
    walk_down
    walk_down
    walk_down
    walk_left
    walk_left
    walk_left
    walk_down
    walk_down
    step_end

PetalburgCity_Gym_Movement_WallysDadEnterGym:
    walk_up
    delay_8
    walk_in_place_faster_right
    delay_8
    walk_in_place_faster_left
    delay_16
    walk_in_place_faster_up
    step_end

PetalburgCity_Gym_Movement_WallysDadApproachPlayerNorth:
    walk_right
    walk_right
    walk_up
    walk_up
    walk_up
    walk_in_place_faster_right
    step_end

PetalburgCity_Gym_Movement_WallysDadApproachPlayerEast:
    walk_right
    walk_right
    walk_up
    walk_up
    walk_up
    step_end

PetalburgCity_Gym_Movement_WallysDadApproachPlayerWest:
    walk_right
    walk_right
    walk_up
    walk_up
    walk_right
    walk_right
    walk_up
    step_end

PetalburgCity_Gym_Movement_Unused:
    walk_in_place_faster_up
    delay_16
    delay_16
    delay_16
    delay_16
    delay_16
    delay_8
    walk_in_place_faster_down
    step_end

PetalburgCity_Gym_Movement_WallyArriveNorth:
    delay_16
    walk_up
    delay_16
    delay_8
    walk_up
    walk_right
    walk_up
    walk_up
    walk_in_place_faster_left
    step_end

PetalburgCity_Gym_Movement_WallyArrive:
    delay_16
    walk_up
    delay_16
    delay_8
    walk_up
    walk_up
    step_end

PetalburgCity_Gym_Movement_WallyExitNorth:
    walk_down
    walk_down
    walk_down
    walk_down
    walk_in_place_faster_up
    delay_16
    walk_in_place_down
    step_end

PetalburgCity_Gym_Movement_WallyExitEast:
    walk_down
    walk_down
    walk_right
    walk_down
    walk_in_place_faster_up
    delay_16
    walk_in_place_down
    step_end

PetalburgCity_Gym_Movement_WallyExitSouthWest:
    walk_down
    walk_down
    walk_down
    walk_in_place_faster_up
    delay_16
    walk_in_place_down
    step_end

PetalburgCity_Gym_Movement_PlayerExitWithWallyNorth:
    delay_16
    delay_16
    delay_16
    walk_down
    walk_down
    walk_down
    delay_8
    step_end

PetalburgCity_Gym_Movement_PlayerExitWithWallySouth:
    delay_16
    delay_16
    walk_right
    walk_down
    walk_down
    walk_down
    walk_down
    walk_down
    delay_8
    step_end

PetalburgCity_Gym_Movement_PlayerExitWithWallyWest:
    delay_16
    delay_16
    walk_down
    walk_down
    walk_down
    walk_down
    delay_8
    step_end

PetalburgCity_Gym_Movement_PlayerExitWithWallyEast:
    walk_in_place_faster_down
    delay_16
    delay_16
    walk_down
    walk_down
    walk_down
    walk_right
    walk_down
    delay_8
    step_end

PetalburgCity_Gym_EventScript_NoAmountOfTrainingIsEnough::
    msgbox PetalburgCity_Gym_Text_DadNoAmountOfTrainingIsEnough, MSGBOX_DEFAULT
    release
    end

PetalburgCity_Gym_EventScript_SpeedRoomDoor::
    lockall
    goto_if_lt VAR_PETALBURG_GYM_STATE, 6, PetalburgCity_Gym_EventScript_DoorLocked
    setvar VAR_0x8008, 7
    setvar VAR_0x8009, 85
    msgbox PetalburgCity_Gym_Text_EnterSpeedRoom, MSGBOX_YESNO
    goto_if_eq VAR_RESULT, YES, PetalburgCity_Gym_EventScript_EnterRoom
    goto_if_eq VAR_RESULT, NO, PetalburgCity_Gym_EventScript_DontEnterRoom
    end

PetalburgCity_Gym_EventScript_EnterRoom::
    closemessage
    delay 30
    warpdoor MAP_PETALBURG_CITY_GYM, VAR_0x8008, VAR_0x8009
    waitstate
    releaseall
    end

PetalburgCity_Gym_EventScript_DontEnterRoom::
    releaseall
    end

PetalburgCity_Gym_EventScript_DoorLocked::
    msgbox PetalburgCity_Gym_Text_DoorAppearsLocked, MSGBOX_DEFAULT
    releaseall
    end

@ VAR_0x8008 and VAR_0x8009 below are the x and y coordinates of the warp
PetalburgCity_Gym_EventScript_AccuracyRoomDoor::
    lockall
    goto_if_lt VAR_PETALBURG_GYM_STATE, 6, PetalburgCity_Gym_EventScript_DoorLocked
    setvar VAR_0x8008, 1
    setvar VAR_0x8009, 98
    msgbox PetalburgCity_Gym_Text_EnterAccuracyRoom, MSGBOX_YESNO
    goto_if_eq VAR_RESULT, YES, PetalburgCity_Gym_EventScript_EnterRoom
    goto_if_eq VAR_RESULT, NO, PetalburgCity_Gym_EventScript_DontEnterRoom
    end

PetalburgCity_Gym_EventScript_ConfusionRoomDoor::
    lockall
    goto_if_not_defeated TRAINER_RANDALL, PetalburgCity_Gym_EventScript_DoorLocked
    setvar VAR_0x8008, 7
    setvar VAR_0x8009, 46
    msgbox PetalburgCity_Gym_Text_EnterConfusionRoom, MSGBOX_YESNO
    goto_if_eq VAR_RESULT, YES, PetalburgCity_Gym_EventScript_EnterRoom
    goto_if_eq VAR_RESULT, NO, PetalburgCity_Gym_EventScript_DontEnterRoom
    end

PetalburgCity_Gym_EventScript_LeftDefenseRoomDoor::
    lockall
    goto_if_not_defeated TRAINER_RANDALL, PetalburgCity_Gym_EventScript_DoorLocked
    setvar VAR_0x8008, 1
    setvar VAR_0x8009, 59
    msgbox PetalburgCity_Gym_Text_EnterDefenseRoom, MSGBOX_YESNO
    goto_if_eq VAR_RESULT, YES, PetalburgCity_Gym_EventScript_EnterRoom
    goto_if_eq VAR_RESULT, NO, PetalburgCity_Gym_EventScript_DontEnterRoom
    end

PetalburgCity_Gym_EventScript_RightDefenseRoomDoor::
    lockall
    goto_if_not_defeated TRAINER_MARY, PetalburgCity_Gym_EventScript_DoorLocked
    setvar VAR_0x8008, 7
    setvar VAR_0x8009, 59
    msgbox PetalburgCity_Gym_Text_EnterDefenseRoom, MSGBOX_YESNO
    goto_if_eq VAR_RESULT, YES, PetalburgCity_Gym_EventScript_EnterRoom
    goto_if_eq VAR_RESULT, NO, PetalburgCity_Gym_EventScript_DontEnterRoom
    end

PetalburgCity_Gym_EventScript_RecoveryRoomDoor::
    lockall
    goto_if_not_defeated TRAINER_MARY, PetalburgCity_Gym_EventScript_DoorLocked
    setvar VAR_0x8008, 1
    setvar VAR_0x8009, 72
    msgbox PetalburgCity_Gym_Text_EnterRecoveryRoom, MSGBOX_YESNO
    goto_if_eq VAR_RESULT, YES, PetalburgCity_Gym_EventScript_EnterRoom
    goto_if_eq VAR_RESULT, NO, PetalburgCity_Gym_EventScript_DontEnterRoom
    end

PetalburgCity_Gym_EventScript_LeftStrengthRoomDoor::
    lockall
    goto_if_not_defeated TRAINER_PARKER, PetalburgCity_Gym_EventScript_DoorLocked
    setvar VAR_0x8008, 1
    setvar VAR_0x8009, 20
    msgbox PetalburgCity_Gym_Text_EnterStrengthRoom, MSGBOX_YESNO
    goto_if_eq VAR_RESULT, YES, PetalburgCity_Gym_EventScript_EnterRoom
    goto_if_eq VAR_RESULT, NO, PetalburgCity_Gym_EventScript_DontEnterRoom
    end

PetalburgCity_Gym_EventScript_RightStrengthRoomDoor::
    lockall
    goto_if_not_defeated TRAINER_ALEXIA, PetalburgCity_Gym_EventScript_DoorLocked
    setvar VAR_0x8008, 7
    setvar VAR_0x8009, 20
    msgbox PetalburgCity_Gym_Text_EnterStrengthRoom, MSGBOX_YESNO
    goto_if_eq VAR_RESULT, YES, PetalburgCity_Gym_EventScript_EnterRoom
    goto_if_eq VAR_RESULT, NO, PetalburgCity_Gym_EventScript_DontEnterRoom
    end

PetalburgCity_Gym_EventScript_LeftOHKORoomDoor::
    lockall
    goto_if_not_defeated TRAINER_ALEXIA, PetalburgCity_Gym_EventScript_DoorLocked
    setvar VAR_0x8008, 1
    setvar VAR_0x8009, 33
    msgbox PetalburgCity_Gym_Text_EnterOHKORoom, MSGBOX_YESNO
    goto_if_eq VAR_RESULT, YES, PetalburgCity_Gym_EventScript_EnterRoom
    goto_if_eq VAR_RESULT, NO, PetalburgCity_Gym_EventScript_DontEnterRoom
    end

PetalburgCity_Gym_EventScript_RightOHKORoomDoor::
    lockall
    goto_if_not_defeated TRAINER_GEORGE, PetalburgCity_Gym_EventScript_DoorLocked
    setvar VAR_0x8008, 7
    setvar VAR_0x8009, 33
    msgbox PetalburgCity_Gym_Text_EnterOHKORoom, MSGBOX_YESNO
    goto_if_eq VAR_RESULT, YES, PetalburgCity_Gym_EventScript_EnterRoom
    goto_if_eq VAR_RESULT, NO, PetalburgCity_Gym_EventScript_DontEnterRoom
    end

PetalburgCity_Gym_EventScript_LeftGymLeadersRoomDoor::
    lockall
    goto_if_not_defeated TRAINER_JODY, PetalburgCity_Gym_EventScript_DoorLocked
    setvar VAR_0x8008, 1
    setvar VAR_0x8009, 7
    msgbox PetalburgCity_Gym_Text_EnterGymLeadersRoom, MSGBOX_YESNO
    goto_if_eq VAR_RESULT, YES, PetalburgCity_Gym_EventScript_EnterRoom
    goto_if_eq VAR_RESULT, NO, PetalburgCity_Gym_EventScript_DontEnterRoom
    end

PetalburgCity_Gym_EventScript_RightGymLeadersRoomDoor::
    lockall
    goto_if_not_defeated TRAINER_BERKE, PetalburgCity_Gym_EventScript_DoorLocked
    setvar VAR_0x8008, 7
    setvar VAR_0x8009, 7
    msgbox PetalburgCity_Gym_Text_EnterGymLeadersRoom, MSGBOX_YESNO
    goto_if_eq VAR_RESULT, YES, PetalburgCity_Gym_EventScript_EnterRoom
    goto_if_eq VAR_RESULT, NO, PetalburgCity_Gym_EventScript_DontEnterRoom
    end

PetalburgCity_Gym_EventScript_Randall::
    trainerbattle_single TRAINER_RANDALL, PetalburgCity_Gym_Text_RandallIntro, PetalburgCity_Gym_Text_RandallDefeat, PetalburgCity_Gym_EventScript_SlideOpenSpeedRoomDoors
    goto_if_set FLAG_DEFEATED_PETALBURG_GYM, PetalburgCity_Gym_EventScript_RandallPostBadge
    msgbox PetalburgCity_Gym_Text_RandallPostBattle, MSGBOX_AUTOCLOSE
    end

PetalburgCity_Gym_EventScript_SlideOpenSpeedRoomDoors::
    setvar VAR_0x8005, 0
    call PetalburgCity_Gym_EventScript_OpenSpeedRoomDoors
    special DrawWholeMapView
    release
    end

PetalburgCity_Gym_EventScript_RandallPostBadge::
    msgbox PetalburgCity_Gym_Text_RandallPostBadge, MSGBOX_NPC
    end

PetalburgCity_Gym_EventScript_Parker::
    trainerbattle_single TRAINER_PARKER, PetalburgCity_Gym_Text_ParkerIntro, PetalburgCity_Gym_Text_ParkerDefeat, PetalburgCity_Gym_EventScript_SlideOpenConfusionRoomDoors
    goto_if_set FLAG_DEFEATED_PETALBURG_GYM, PetalburgCity_Gym_EventScript_ParkerPostBadge
    msgbox PetalburgCity_Gym_Text_ParkerPostBattle, MSGBOX_AUTOCLOSE
    end

PetalburgCity_Gym_EventScript_SlideOpenConfusionRoomDoors::
    setvar VAR_0x8005, 0
    call PetalburgCity_Gym_EventScript_OpenConfusionRoomDoors
    special DrawWholeMapView
    release
    end

PetalburgCity_Gym_EventScript_ParkerPostBadge::
    msgbox PetalburgCity_Gym_Text_ParkerPostBadge, MSGBOX_NPC
    end

PetalburgCity_Gym_EventScript_George::
    trainerbattle_single TRAINER_GEORGE, PetalburgCity_Gym_Text_GeorgeIntro, PetalburgCity_Gym_Text_GeorgeDefeat, PetalburgCity_Gym_EventScript_SlideOpenRecoveryRoomDoors
    goto_if_set FLAG_DEFEATED_PETALBURG_GYM, PetalburgCity_Gym_EventScript_GeorgePostBadge
    msgbox PetalburgCity_Gym_Text_GeorgePostBattle, MSGBOX_AUTOCLOSE
    end

PetalburgCity_Gym_EventScript_SlideOpenRecoveryRoomDoors::
    setvar VAR_0x8005, 0
    call PetalburgCity_Gym_EventScript_OpenRecoveryRoomDoors
    special DrawWholeMapView
    release
    end

PetalburgCity_Gym_EventScript_GeorgePostBadge::
    msgbox PetalburgCity_Gym_Text_GeorgePostBadge, MSGBOX_NPC
    end

PetalburgCity_Gym_EventScript_Berke::
    trainerbattle_single TRAINER_BERKE, PetalburgCity_Gym_Text_BerkeIntro, PetalburgCity_Gym_Text_BerkeDefeat, PetalburgCity_Gym_EventScript_SlideOpenOHKORoomDoors
    goto_if_set FLAG_DEFEATED_PETALBURG_GYM, PetalburgCity_Gym_EventScript_BerkePostBadge
    msgbox PetalburgCity_Gym_Text_BerkePostBattle, MSGBOX_AUTOCLOSE
    end

PetalburgCity_Gym_EventScript_SlideOpenOHKORoomDoors::
    setvar VAR_0x8005, 0
    call PetalburgCity_Gym_EventScript_OpenOHKORoomDoors
    special DrawWholeMapView
    release
    end

PetalburgCity_Gym_EventScript_BerkePostBadge::
    msgbox PetalburgCity_Gym_Text_BerkePostBadge, MSGBOX_NPC
    end

PetalburgCity_Gym_EventScript_Mary::
    trainerbattle_single TRAINER_MARY, PetalburgCity_Gym_Text_MaryIntro, PetalburgCity_Gym_Text_MaryDefeat, PetalburgCity_Gym_EventScript_SlideOpenAccuracyRoomDoors
    goto_if_set FLAG_DEFEATED_PETALBURG_GYM, PetalburgCity_Gym_EventScript_MaryPostBadge
    msgbox PetalburgCity_Gym_Text_MaryPostBattle, MSGBOX_AUTOCLOSE
    end

PetalburgCity_Gym_EventScript_SlideOpenAccuracyRoomDoors::
    setvar VAR_0x8005, 0
    call PetalburgCity_Gym_EventScript_OpenAccuracyRoomDoors
    special DrawWholeMapView
    release
    end

PetalburgCity_Gym_EventScript_MaryPostBadge::
    msgbox PetalburgCity_Gym_Text_MaryPostBadge, MSGBOX_NPC
    end

PetalburgCity_Gym_EventScript_Alexia::
    trainerbattle_single TRAINER_ALEXIA, PetalburgCity_Gym_Text_AlexiaIntro, PetalburgCity_Gym_Text_AlexiaDefeat, PetalburgCity_Gym_EventScript_SlideOpenDefenseRoomDoors
    goto_if_set FLAG_DEFEATED_PETALBURG_GYM, PetalburgCity_Gym_EventScript_AlexiaPostBadge
    msgbox PetalburgCity_Gym_Text_AlexiaPostBattle, MSGBOX_AUTOCLOSE
    end

PetalburgCity_Gym_EventScript_SlideOpenDefenseRoomDoors::
    setvar VAR_0x8005, 0
    call PetalburgCity_Gym_EventScript_OpenDefenseRoomDoors
    special DrawWholeMapView
    release
    end

PetalburgCity_Gym_EventScript_AlexiaPostBadge::
    msgbox PetalburgCity_Gym_Text_AlexiaPostBadge, MSGBOX_NPC
    end

PetalburgCity_Gym_EventScript_Jody::
    trainerbattle_single TRAINER_JODY, PetalburgCity_Gym_Text_JodyIntro, PetalburgCity_Gym_Text_JodyDefeat, PetalburgCity_Gym_EventScript_SlideOpenStrengthRoomDoors
    goto_if_set FLAG_DEFEATED_PETALBURG_GYM, PetalburgCity_Gym_EventScript_JodyPostBadge
    msgbox PetalburgCity_Gym_Text_JodyPostBattle, MSGBOX_AUTOCLOSE
    end

PetalburgCity_Gym_EventScript_SlideOpenStrengthRoomDoors::
    setvar VAR_0x8005, 0
    call PetalburgCity_Gym_EventScript_OpenStrengthRoomDoors
    special DrawWholeMapView
    release
    end

PetalburgCity_Gym_EventScript_JodyPostBadge::
    msgbox PetalburgCity_Gym_Text_JodyPostBadge, MSGBOX_NPC
    end

@ VAR_0x8004 below is the room number
@ VAR_0x8005 below is 0 when the door should be slid open and 1 when it should be unlocked immediately
PetalburgCity_Gym_EventScript_OpenGymEntranceDoors::
    setvar VAR_0x8004, 1
    call_if_eq VAR_0x8005, 0, PetalburgCity_Gym_EventScript_SlideOpenRoomDoors
    call_if_eq VAR_0x8005, 1, PetalburgCity_Gym_EventScript_UnlockRoomDoors
    call PetalburgCity_Gym_EventScript_SetEntranceRoomDoorMetatiles
    return

PetalburgCity_Gym_EventScript_OpenSpeedRoomDoors::
    setvar VAR_0x8004, 2
    call_if_eq VAR_0x8005, 0, PetalburgCity_Gym_EventScript_SlideOpenRoomDoors
    call_if_eq VAR_0x8005, 1, PetalburgCity_Gym_EventScript_UnlockRoomDoors
    call PetalburgCity_Gym_EventScript_SetSpeedRoomDoorMetatiles
    return

PetalburgCity_Gym_EventScript_OpenAccuracyRoomDoors::
    setvar VAR_0x8004, 3
    call_if_eq VAR_0x8005, 0, PetalburgCity_Gym_EventScript_SlideOpenRoomDoors
    call_if_eq VAR_0x8005, 1, PetalburgCity_Gym_EventScript_UnlockRoomDoors
    call PetalburgCity_Gym_EventScript_SetAccuracyRoomDoorMetatiles
    return

PetalburgCity_Gym_EventScript_OpenConfusionRoomDoors::
    setvar VAR_0x8004, 4
    call_if_eq VAR_0x8005, 0, PetalburgCity_Gym_EventScript_SlideOpenRoomDoors
    call_if_eq VAR_0x8005, 1, PetalburgCity_Gym_EventScript_UnlockRoomDoors
    call PetalburgCity_Gym_EventScript_SetConfusionRoomDoorMetatiles
    return

PetalburgCity_Gym_EventScript_OpenDefenseRoomDoors::
    setvar VAR_0x8004, 5
    call_if_eq VAR_0x8005, 0, PetalburgCity_Gym_EventScript_SlideOpenRoomDoors
    call_if_eq VAR_0x8005, 1, PetalburgCity_Gym_EventScript_UnlockRoomDoors
    call PetalburgCity_Gym_EventScript_SetDefenseRoomDoorMetatiles
    return

PetalburgCity_Gym_EventScript_OpenRecoveryRoomDoors::
    setvar VAR_0x8004, 6
    call_if_eq VAR_0x8005, 0, PetalburgCity_Gym_EventScript_SlideOpenRoomDoors
    call_if_eq VAR_0x8005, 1, PetalburgCity_Gym_EventScript_UnlockRoomDoors
    call PetalburgCity_Gym_EventScript_SetRecoveryRoomDoorMetatiles
    return

PetalburgCity_Gym_EventScript_OpenStrengthRoomDoors::
    setvar VAR_0x8004, 7
    call_if_eq VAR_0x8005, 0, PetalburgCity_Gym_EventScript_SlideOpenRoomDoors
    call_if_eq VAR_0x8005, 1, PetalburgCity_Gym_EventScript_UnlockRoomDoors
    call PetalburgCity_Gym_EventScript_SetStrengthRoomDoorMetatiles
    return

PetalburgCity_Gym_EventScript_OpenOHKORoomDoors::
    setvar VAR_0x8004, 8
    call_if_eq VAR_0x8005, 0, PetalburgCity_Gym_EventScript_SlideOpenRoomDoors
    call_if_eq VAR_0x8005, 1, PetalburgCity_Gym_EventScript_UnlockRoomDoors
    call PetalburgCity_Gym_EventScript_SetOHKORoomDoorMetatiles
    return

PetalburgCity_Gym_EventScript_SetEntranceRoomDoorMetatiles::
    setmetatile 6, 85, METATILE_PetalburgGym_RoomEntrance_Left, FALSE
    setmetatile 7, 85, METATILE_PetalburgGym_RoomEntrance_Right, FALSE
    setmetatile 1, 98, METATILE_PetalburgGym_RoomEntrance_Left, FALSE
    setmetatile 2, 98, METATILE_PetalburgGym_RoomEntrance_Right, FALSE
    return

PetalburgCity_Gym_EventScript_SetSpeedRoomDoorMetatiles::
    setmetatile 6, 46, METATILE_PetalburgGym_RoomEntrance_Left, FALSE
    setmetatile 7, 46, METATILE_PetalburgGym_RoomEntrance_Right, FALSE
    setmetatile 1, 59, METATILE_PetalburgGym_RoomEntrance_Left, FALSE
    setmetatile 2, 59, METATILE_PetalburgGym_RoomEntrance_Right, FALSE
    return

PetalburgCity_Gym_EventScript_SetAccuracyRoomDoorMetatiles::
    setmetatile 6, 59, METATILE_PetalburgGym_RoomEntrance_Left, FALSE
    setmetatile 7, 59, METATILE_PetalburgGym_RoomEntrance_Right, FALSE
    setmetatile 1, 72, METATILE_PetalburgGym_RoomEntrance_Left, FALSE
    setmetatile 2, 72, METATILE_PetalburgGym_RoomEntrance_Right, FALSE
    return

PetalburgCity_Gym_EventScript_SetConfusionRoomDoorMetatiles::
    setmetatile 1, 20, METATILE_PetalburgGym_RoomEntrance_Left, FALSE
    setmetatile 2, 20, METATILE_PetalburgGym_RoomEntrance_Right, FALSE
    return

PetalburgCity_Gym_EventScript_SetDefenseRoomDoorMetatiles::
    setmetatile 6, 20, METATILE_PetalburgGym_RoomEntrance_Left, FALSE
    setmetatile 7, 20, METATILE_PetalburgGym_RoomEntrance_Right, FALSE
    setmetatile 1, 33, METATILE_PetalburgGym_RoomEntrance_Left, FALSE
    setmetatile 2, 33, METATILE_PetalburgGym_RoomEntrance_Right, FALSE
    return

PetalburgCity_Gym_EventScript_SetRecoveryRoomDoorMetatiles::
    setmetatile 6, 33, METATILE_PetalburgGym_RoomEntrance_Left, FALSE
    setmetatile 7, 33, METATILE_PetalburgGym_RoomEntrance_Right, FALSE
    return

PetalburgCity_Gym_EventScript_SetStrengthRoomDoorMetatiles::
    setmetatile 1, 7, METATILE_PetalburgGym_RoomEntrance_Left, FALSE
    setmetatile 2, 7, METATILE_PetalburgGym_RoomEntrance_Right, FALSE
    return

PetalburgCity_Gym_EventScript_SetOHKORoomDoorMetatiles::
    setmetatile 6, 7, METATILE_PetalburgGym_RoomEntrance_Left, FALSE
    setmetatile 7, 7, METATILE_PetalburgGym_RoomEntrance_Right, FALSE
    return

PetalburgCity_Gym_EventScript_SlideOpenRoomDoors::
    special PetalburgGymSlideOpenRoomDoors
    waitstate
    return

PetalburgCity_Gym_EventScript_UnlockRoomDoors::
    special PetalburgGymUnlockRoomDoors
    return

PetalburgCity_Gym_EventScript_GymGuide::
    lock
    faceplayer
    goto_if_set FLAG_DEFEATED_PETALBURG_GYM, PetalburgCity_Gym_EventScript_GymGuidePostVictory
    msgbox PetalburgCity_Gym_Text_GymGuideAdvice, MSGBOX_DEFAULT
    release
    end

PetalburgCity_Gym_EventScript_GymGuidePostVictory::
    msgbox PetalburgCity_Gym_Text_GymGuidePostVictory, MSGBOX_DEFAULT
    release
    end

PetalburgCity_Gym_EventScript_LeftGymStatue::
    lockall
    goto_if_set FLAG_BADGE05_GET, PetalburgCity_Gym_EventScript_GymStatueCertified
    goto PetalburgCity_Gym_EventScript_GymStatue
    end

PetalburgCity_Gym_EventScript_RightGymStatue::
    lockall
    goto_if_set FLAG_BADGE05_GET, PetalburgCity_Gym_EventScript_GymStatueCertified
    goto PetalburgCity_Gym_EventScript_GymStatue
    end

PetalburgCity_Gym_EventScript_GymStatueCertified::
    msgbox PetalburgCity_Gym_Text_GymStatueCertified, MSGBOX_DEFAULT
    releaseall
    end

PetalburgCity_Gym_EventScript_GymStatue::
    msgbox PetalburgCity_Gym_Text_GymStatue, MSGBOX_DEFAULT
    releaseall
    end
`

text PetalburgCity_Gym_Text_NormanGoToRustboro {
    "Hm? Aren't you going to the\n"
    "Pokémon Gym in Rustboro City?\p"
    "There's no challenge for me to\n"
    "battle a greenhorn Trainer.\p"
    "{PLAYER}, I want you to challenge me\n"
    "when you become a lot stronger.\p"
    "I'll battle you, {PLAYER}, when you\n"
    "can show me four Gym Badges, okay?"
}

text PetalburgCity_Gym_Text_NormanGoToDewford {
    "I see… So, you've beaten\n"
    "the Gym Leader in Rustboro City.\p"
    "But there are many more Trainers\n"
    "who are stronger than you, {PLAYER}.\p"
    "Across the sea in Dewford Town is a\n"
    "Gym Leader named Brawly.\p"
    "You should go challenge him.$"
}

text PetalburgCity_Gym_Text_YouHaveGottenStronger {
    format("Hm… {PLAYER}, you have gotten stronger.\p"
    "I can tell by the number of Badges that you've earned.")
}

text PetalburgCity_Gym_Text_NormanDefeat {
    "…\p"
    "I… I can't…\p"
    "I can't believe it. {PLAYER}…\p"
    "I lost to {PLAYER}?\p"
    "But, rules are rules!\n"
    "Here, take this.$"
}

text PetalburgCity_Gym_Text_ExplainFacade {
    "TM42 contains Facade.\p"
    "It doubles the power of moves if\n"
    "the Pokémon is poisoned, paralyzed,\l"
    "or burned.\p"
    "It might be able to turn a bad\n"
    "situation into an advantage.$"
}

text PetalburgCity_Gym_Text_PleaseComeWithMe {
    "Ah, there you are, {PLAYER}{KUN}!\p"
    "Please come with me.\n"
    "I have something I want you to have.$"
}

text PetalburgCity_Gym_Text_LetMeBorrowPlayer {
    "Norman, you don't mind, do you?\p"
    "Let me borrow your {PLAYER}{KUN} for\n"
    "a minute or two.$"
}

text PetalburgCity_Gym_Text_DadGoingToKeepTraining {
    format("{PLAYER}, you should go visit your mother every so often.\p"
    "I'm going to stay here and redouble my training.\p"
    "It would bother me as a Trainer to not avenge my loss to you, {PLAYER}!$")
}

text PetalburgCity_Gym_Text_DadNoAmountOfTrainingIsEnough {
    format("{PLAYER}, how are things going?\p"
    "The world of Pokémon is deep.\p"
    "I honestly think that no amount of training would ever be enough.")
}

text PetalburgCity_Gym_Text_GymGuideAdvice {
    format("Hey, how's it going, Champion-\n"
    "bound {PLAYER}?\p"
    "The doors in this Gym open when you beat the awaiting Trainers.\p"
    "Whoops! The doors in this room are already open, so don't attack me!\p"
    "The Trainers of Petalburg Gym use all kinds of items.\p"
    "The door at the left leads to the Speed Room.\p"
    "The door at the right leads to the Accuracy Room.\p"
    "The room's name will be on the door, so choose carefully.\p"
    "Once you've chosen the door…\n"
    "Well, hey, go for it!$")
}

text PetalburgCity_Gym_Text_GymGuidePostVictory {
    "{PLAYER}! Whoa! You've overcome even\n"
    "your own father!\p"
    "Like, whoa!\n"
    "What a stunning turn of events!$"
}

text PetalburgCity_Gym_Text_RandallIntro {
    "The ability to attack before the\n"
    "opponent…\p"
    "Just that alone puts me at a great\n"
    "advantage, don't you agree?$"
}

text PetalburgCity_Gym_Text_RandallDefeat {
    "That was a magnificent battle!$"
}

text PetalburgCity_Gym_Text_RandallPostBattle {
    format("Go on to the next room where a new challenge awaits you.\p"
    "At the left is the Confusion Room.\p"
    "The right door leads to the Defense Room.")
}

text PetalburgCity_Gym_Text_RandallPostBadge {
    format("Whomever you beat, and whomever you may lose to, you never shirk from training yourself and your Pokémon.\p"
    "That's what I think being a Gym Leader is all about.")
}

text PetalburgCity_Gym_Text_ParkerIntro {
    "This is the Confusion Room.\p"
    "Let me see how well bonded you are\n"
    "with your Pokémon!$"
}

text PetalburgCity_Gym_Text_ParkerDefeat {
    "I couldn't confuse your team enough…\n"
    "You share a strong bond together.$"
}

text PetalburgCity_Gym_Text_ParkerPostBattle {
    "The next room is the Strength Room.\n"
    "Can you withstand brute force?$"
}

text PetalburgCity_Gym_Text_ParkerPostBadge {
    "After you beat our Leader, the\n"
    "training has become a lot tougher.$"
}

text PetalburgCity_Gym_Text_GeorgeIntro {
    "Just when you think you're going to\n"
    "win, your opponent restores HP…\p"
    "Can you just imagine how awful that\n"
    "must feel?\p"
    "I'll show you exactly how awful it\n"
    "feels!$"
}

text PetalburgCity_Gym_Text_GeorgeDefeat {
    "I couldn't restore HP enough…\n"
    "What Attack power…$"
}

text PetalburgCity_Gym_Text_GeorgePostBattle {
    "I should have expected no less from\n"
    "our Leader's kid.\p"
    "No, wait! A Trainer's abilities are\n"
    "earned only through effort.\p"
    "I lost because my own efforts\n"
    "weren't enough.\p"
    "Go on! The One-Hit KO Room is next.$"
}

text PetalburgCity_Gym_Text_GeorgePostBadge {
    "I'm going to keep training at Gyms.\n"
    "One day, I'll become a Leader.$"
}

text PetalburgCity_Gym_Text_BerkeIntro {
    "I'm not going to take it easy just\n"
    "because you're our Leader's kid.\p"
    "I'll show you how horrid it is for\n"
    "a Pokémon to take a critical hit!$"
}

text PetalburgCity_Gym_Text_BerkeDefeat {
    "Your power…\n"
    "You're the real deal.$"
}

text PetalburgCity_Gym_Text_BerkePostBattle {
    "Your father really is strong.\n"
    "He's a Trainer worth my respect.\p"
    "And, I sense the same glow coming\n"
    "from you as your father.\p"
    "I hope that you'll stage a terrific\n"
    "battle with your father!$"
}

text PetalburgCity_Gym_Text_BerkePostBadge {
    "Since your dad became the Leader,\n"
    "the Trainers of Petalburg City have\l"
    "become a lot tougher.$"
}

text PetalburgCity_Gym_Text_MaryIntro {
    "Giggle…\n"
    "This is the Accuracy Room.\p"
    "It's pretty nasty when every attack\n"
    "lands without fail.$"
}

text PetalburgCity_Gym_Text_MaryDefeat {
    "You were a cut above me…$"
}

text PetalburgCity_Gym_Text_MaryPostBattle {
    "There are some even stronger\n"
    "Trainers waiting for you.\p"
    "The left is the Defense Room, and\n"
    "the right is the Recovery Room.\p"
    "Your Pokémon's Attack power will be\n"
    "on trial either way.$"
}

text PetalburgCity_Gym_Text_MaryPostBadge {
    "Do you know what we're trying to\n"
    "achieve as Trainers?\p"
    "We're striving to become soul mates\n"
    "with our Pokémon.$"
}

text PetalburgCity_Gym_Text_AlexiaIntro {
    "The higher the Defense, the more\n"
    "reckless I can be in attack.$"
}

text PetalburgCity_Gym_Text_AlexiaDefeat {
    "Our defenses weren't enough…$"
}

text PetalburgCity_Gym_Text_AlexiaPostBattle {
    "I think you've taught me a valuable\n"
    "lesson here.\p"
    "Now, go on! The left door goes to\n"
    "the Strength Room.\p"
    "The right door opens to\n"
    "the One-Hit KO Room.\p"
    "Both of them have Trainers who are\n"
    "skilled at offense.$"
}

text PetalburgCity_Gym_Text_AlexiaPostBadge {
    "Hi! Have you tried using Surf?$"
}

text PetalburgCity_Gym_Text_JodyIntro {
    "Our Gym Leader told us to go all out\n"
    "and beat you.\p"
    "Even if you happen to be the\n"
    "Leader's kid!$"
}

text PetalburgCity_Gym_Text_JodyDefeat {
    "But… I went all out!$"
}

text PetalburgCity_Gym_Text_JodyPostBattle {
    "The way you use your Pokémon…\n"
    "It's like your father's style.\p"
    "Go on through! The Gym Leader, your\n"
    "father, is waiting!$"
}

text PetalburgCity_Gym_Text_JodyPostBadge {
    "Sure, it's fine to make your Pokémon\n"
    "stronger.\p"
    "But what decides the winner?\p"
    "Why, it's the feelings Trainers have\n"
    "for their Pokémon.$"
}

text PetalburgCity_Gym_Text_DoorAppearsLocked {
    "This door appears to be locked\n"
    "right now…$"
}

text PetalburgCity_Gym_Text_EnterSpeedRoom {
    "“Speed Room,” the sign says.\p"
    "Do you want to go through?$"
}

text PetalburgCity_Gym_Text_EnterAccuracyRoom {
    "“Accuracy Room,” the sign says.\p"
    "Do you want to go through?$"
}

text PetalburgCity_Gym_Text_EnterConfusionRoom {
    "“Confusion Room,” the sign says.\p"
    "Do you want to go through?$"
}

text PetalburgCity_Gym_Text_EnterDefenseRoom {
    "“Defense Room,” the sign says.\p"
    "Do you want to go through?$"
}

text PetalburgCity_Gym_Text_EnterRecoveryRoom {
    "“Recovery Room,” the sign says.\p"
    "Do you want to go through?$"
}

text PetalburgCity_Gym_Text_EnterStrengthRoom {
    "“Strength Room,” the sign says.\p"
    "Do you want to go through?$"
}

text PetalburgCity_Gym_Text_EnterOHKORoom {
    "“One-Hit KO Room,” the sign says.\p"
    "Do you want to go through?$"
}

text PetalburgCity_Gym_Text_EnterGymLeadersRoom {
    "“Gym Leader's Room\p"
    "“See for yourself what Pokémon await\n"
    "you!” the sign says.\p"
    "Do you want to go through?$"
}

text PetalburgCity_Gym_Text_GymStatue {
    "Petalburg City Pokémon Gym$"
}

text PetalburgCity_Gym_Text_GymStatueCertified {
    "Petalburg City Pokémon Gym\p"
    "Norman's Certified Trainers:\n"
    "{PLAYER}$"
}

text PetalburgCity_Gym_Text_NormanPreRematch {
    format("{PLAYER}…\n"
    "I had a feeling that you would come.\p"
    "I would never refuse to accept a challenge from you.\p"
    "You do understand, don't you?\p"
    "Inside a Gym, it doesn't matter that we are a parent and child.\p"
    "…No, because we are parent and child, we owe it to each other to do the best we can. Isn't that right, {PLAYER}?")
}

text PetalburgCity_Gym_Text_NormanRematchDefeat {
    "Uh… Haha…\n"
    "Maybe that was going too hard…$"
}

text PetalburgCity_Gym_Text_NormanPostRematch {
    "{PLAYER}…\n"
    "What is your dream?\p"
    "My dream…\n"
    "Hahaha…\l"
    "It has already come true, actually.$"
}

text PetalburgCity_Gym_Text_NormanRematchNeedTwoMons {
    format("{PLAYER}…\n"
    "I had a feeling that you would come.\p"
    "I would never refuse to accept a challenge from you.\p"
    "You do understand, don't you?\p"
    "Inside a Gym, it doesn't matter that we are a parent and child.\p"
    "Hm? Wait a second, {PLAYER}.\p"
    "Do you only have one Pokémon that is capable of battle?\p"
    "Sorry, but you'll have to come back with at least two Pokémon.")
}

script PetalburgCity_Gym_EventScript_ReturnFromWallyTutorial {
    lockall
    speakername(CommonName_Text_Dad)
    msgbox("So, did it work out?", MSGBOX_DEFAULT)
    speakername(CommonName_Text_Wally)
    msgbox(format("Thank you, yes, it did.\n"
        "Here's your Pokémon back.\p"
        "{PLAYER}, thank you for coming along with me.\p"
        "You two are why I was able to catch my Pokémon.\p"
        "I promise I'll take really good care of it.\p"
        "Oh! My mom's waiting for me, so I have to go!\p"
        "Bye, {PLAYER}!"), MSGBOX_DEFAULT)
    closemessage
    applymovement(OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterDown)
    applymovement(LOCALID_WALLY, PetalburgCity_Gym_Movement_WallyExitGym)
    waitmovement(0)
    playse(SE_EXIT)
    removeobject(LOCALID_WALLY)
    setflag(FLAG_HIDE_PETALBURG_CITY_WALLY)
    delay(30)
    applymovement(OBJ_EVENT_ID_PLAYER, Common_Movement_WalkInPlaceFasterUp)
    waitmovement(0)
    speakername(CommonName_Text_Dad)
    msgbox(format("Now…\p"
        "{PLAYER}, if you want to become a strong Trainer, here's my advice.\p"
        "Head for Rustboro City beyond this town.\p"
        "There, you should challenge the Gym Leader, Roxanne.\p"
        "After her, go on to other Pokémon Gyms and defeat their Leaders.\p"
        "Collect Badges from them, understood?\p"
        "Of course, I'm a Gym Leader, too.\n"
        "We'll battle one day, {PLAYER}.\p"
        "But that's only after you become stronger."), MSGBOX_DEFAULT)
    setvar(VAR_PETALBURG_GYM_STATE, 2)
    releaseall
}

script PetalburgCity_Gym_EventScript_BeginWallyTutorial {
    addobject(LOCALID_WALLY)
    playse(SE_DOOR)
    call_if_eq(VAR_0x8008, 0, PetalburgCity_Gym_EventScript_WallyArriveSouth)
    call_if_eq(VAR_0x8008, 1, PetalburgCity_Gym_EventScript_WallyArriveNorth)
    call_if_eq(VAR_0x8008, 2, PetalburgCity_Gym_EventScript_WallyArriveWestEast)
    call_if_eq(VAR_0x8008, 3, PetalburgCity_Gym_EventScript_WallyArriveWestEast)
    speakername(CommonName_Text_Wally)
    msgbox("Um… I…\n"
        "I'd like to get a Pokémon, please…", MSGBOX_DEFAULT)
    speakername(CommonName_Text_Dad)
    msgbox("Hm? You're… Uh… Oh, right.\n"
        "You're Wally, right?", MSGBOX_DEFAULT)
    speakername(CommonName_Text_Wally)
    msgbox(format("I'm going to go stay with my relatives in Verdanturf Town.\p"
        "I thought I would be lonely by myself, so I wanted to take a Pokémon along.\p"
        "But I've never caught a Pokémon before.\n"
        "I don't know how…"), MSGBOX_DEFAULT)
    speakername(CommonName_Text_Dad)
    msgbox("Hm. I see.", MSGBOX_DEFAULT)
    call_if_eq(VAR_0x8008, 0, PetalburgCity_Gym_EventScript_NormanAddressPlayerSouth)
    call_if_eq(VAR_0x8008, 1, PetalburgCity_Gym_EventScript_NormanAddressPlayerNorth)
    call_if_eq(VAR_0x8008, 2, PetalburgCity_Gym_EventScript_NormanAddressPlayerWest)
    call_if_eq(VAR_0x8008, 3, PetalburgCity_Gym_EventScript_NormanAddressPlayerEast)
    speakername(CommonName_Text_Dad)
    msgbox(format("{PLAYER}, you heard that, right?\p"
    "Go with Wally and make sure that he safely catches a Pokémon."), MSGBOX_DEFAULT)
    call_if_eq(VAR_0x8008, 0, PetalburgCity_Gym_EventScript_NormanAddressWallySouth)
    call_if_eq(VAR_0x8008, 1, PetalburgCity_Gym_EventScript_NormanAddressWallyNorth)
    call_if_eq(VAR_0x8008, 2, PetalburgCity_Gym_EventScript_NormanAddressWallyWest)
    call_if_eq(VAR_0x8008, 3, PetalburgCity_Gym_EventScript_NormanAddressWallyEast)
    speakername(CommonName_Text_Dad)
    msgbox("Wally, here, I'll loan you my Pokémon.", MSGBOX_DEFAULT)
    msgbox("Wally received a Zigzagoon!", MSGBOX_DEFAULT)
    speakername(CommonName_Text_Wally)
    msgbox("Oh, wow!\nA Pokémon!", MSGBOX_DEFAULT)
    speakername(CommonName_Text_Dad)
    msgbox("Hm. I'll give you a Poké Ball, too.\nGo for it!", MSGBOX_DEFAULT)
    msgbox("Wally received a Poké Ball!", MSGBOX_DEFAULT)
    speakername(CommonName_Text_Wally)
    msgbox("Oh, wow!\nThank you!", MSGBOX_DEFAULT)
    call_if_eq(VAR_0x8008, 0, PetalburgCity_Gym_EventScript_NormanFaceDoorSouth)
    call_if_eq(VAR_0x8008, 1, PetalburgCity_Gym_EventScript_NormanFaceDoorNorth)
    call_if_eq(VAR_0x8008, 2, PetalburgCity_Gym_EventScript_NormanFaceDoorWest)
    call_if_eq(VAR_0x8008, 3, PetalburgCity_Gym_EventScript_NormanFaceDoorEast)
    call_if_eq(VAR_0x8008, 0, PetalburgCity_Gym_EventScript_WallyFacePlayer)
    call_if_eq(VAR_0x8008, 1, PetalburgCity_Gym_EventScript_WallyFaceDown)
    call_if_eq(VAR_0x8008, 2, PetalburgCity_Gym_EventScript_WallyFacePlayer)
    call_if_eq(VAR_0x8008, 3, PetalburgCity_Gym_EventScript_WallyFacePlayer)
    speakername(CommonName_Text_Wally)
    msgbox(format("{PLAYER}… Would you really come\n with me?"), MSGBOX_DEFAULT)
    closemessage
    setflag(FLAG_DONT_TRANSITION_MUSIC)
    playbgm(MUS_FOLLOW_ME, FALSE)
    call_if_eq(VAR_0x8008, 0, PetalburgCity_Gym_EventScript_ExitGymWithWallySouth)
    call_if_eq(VAR_0x8008, 1, PetalburgCity_Gym_EventScript_ExitGymWithWallyNorth)
    call_if_eq(VAR_0x8008, 2, PetalburgCity_Gym_EventScript_ExitGymWithWallyWest)
    call_if_eq(VAR_0x8008, 3, PetalburgCity_Gym_EventScript_ExitGymWithWallyEast)
    removeobject(LOCALID_WALLY)
    setflag(FLAG_HIDE_PETALBURG_CITY_WALLYS_MOM)
    setvar(VAR_PETALBURG_GYM_STATE, 1)
    setvar(VAR_PETALBURG_CITY_STATE, 2)
    clearflag(FLAG_HIDE_PETALBURG_CITY_WALLY)
    clearflag(FLAG_HIDE_PETALBURG_GYM_WALLY)
    setflag(FLAG_HIDE_LITTLEROOT_TOWN_BIRCHS_LAB_RIVAL)
    special(InitBirchState)
    warp(MAP_PETALBURG_CITY, 15, 8)
    waitstate
    release
}

text PetalburgCity_Gym_Text_DadYoureHereWithYourPokemon {
    format("DAD: Hm?\p"
        "Well, if it isn't {PLAYER}!\n"
        "So you're all finished moving in?\p"
        "I'm surprised that you managed to get here by yourself.\p"
        "Oh, I see.\n"
        "You're with your Pokémon.\p"
        "Hm… Then I guess you're going to become a Trainer like me, {PLAYER}.\p"
        "That's great news!\n"
        "I'll be looking forward to it!")
}
